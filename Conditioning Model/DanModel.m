%% Initialize Script
clear; close all; clc;

lowers = zeros(40, 1);
highers = zeros(40, 1);

paths = {'../rawdata/401/behaviour/73720142520_401_final.mat'...
    '../rawdata/402/behaviour/73720150608_402_final.mat'...
    '../rawdata/403/behaviour/73720152564_403_final.mat'...
    '../rawdata/404/behaviour/73720155850_404_final.mat'...
    '../rawdata/405/behaviour/73720156669_405_final.mat'...
    '../rawdata/406/behaviour/73720159049_406_final.mat'...
    '../rawdata/407/behaviour/73720161028_407_final.mat'...
    '../rawdata/408/behaviour/73720162961_408_final.mat'...
    '../rawdata/409/behaviour/73720164954_409_final.mat'...
    '../rawdata/410/behaviour/73720167109_410_final.mat'...
    '../rawdata/411/behaviour/73720169470_411_final.mat'...
    '../rawdata/412/behaviour/73720171945_412_final.mat'...
    '../rawdata/413/behaviour/73720173437_413_final.mat'...
    '../rawdata/414/behaviour/73720175732_414_final.mat'...
    '../rawdata/415/behaviour/73720176928_415_final.mat'...
    '../rawdata/416/behaviour/73720179851_416_final.mat'...
    '../rawdata/417/behaviour/73720182141_417_final.mat'...
    '../rawdata/418/behaviour/73720344402_418_final.mat'...
    '../rawdata/419/behaviour/73720355214_419_final.mat'...
    '../rawdata/420/behaviour/73720356392_420_final.mat'...
    '../rawdata/421/behaviour/73720360968_421_final.mat'...
    '../rawdata/422/behaviour/73720450617_422_final.mat'...
    '../rawdata/423/behaviour/73720455190_423_final.mat'...
    '../rawdata/424/behaviour/73720459626_424_final.mat'...
    '../rawdata/425/behaviour/73720464763_425_final.mat'...
    '../rawdata/426/behaviour/73720468009_426_final.mat'...
    '../rawdata/427/behaviour/73720480045_427_final.mat'...
    '../rawdata/428/behaviour/73720542103_428_final.mat'...
    '../rawdata/429/behaviour/73720548914_429_final.mat'...
    '../rawdata/430/behaviour/73720550857_430_final.mat'...
    '../rawdata/431/behaviour/73720553417_431_final.mat'...
    '../rawdata/432/behaviour/73720555135_432_final.mat'...
    '../rawdata/433/behaviour/73720559083_433_final.mat'...
    '../rawdata/434/behaviour/73720562285_434_final.mat'...
    '../rawdata/435/behaviour/73720657092_435_final.mat'...
    '../rawdata/436/behaviour/73720659063_436_final.mat'...
    '../rawdata/437/behaviour/73720661163_437_final.mat'...
    '../rawdata/438/behaviour/73720663116_438_final.mat'...
    '../rawdata/439/behaviour/73721162670_439_final.mat'...
    '../rawdata/440/behaviour/73721247059_440_final.mat'...
    '../rawdata/512/behaviour/73753250356_512_final.mat'...
    '../rawdata/513/behaviour/73753250360_513_final.mat'...
    '../rawdata/514/behaviour/73753250347_514_final.mat'...
    '../rawdata/515/behaviour/73753948511_515_final.mat'...
    '../rawdata/516/behaviour/73753948521_516_final.mat'...
    '../rawdata/517/behaviour/73753948879_517_final.mat'...
    '../rawdata/518/behaviour/73753948516_518_final.mat'...
    '../rawdata/519/behaviour/73754059249_519_final.mat'...
    '../rawdata/520/behaviour/73754059206_520_final.mat'...
    '../rawdata/521/behaviour/73754059216_521_final.mat'...
    '../rawdata/522/behaviour/73754465179_522_final.mat'...
    '../rawdata/523/behaviour/73754465434_523_final.mat'...
    '../rawdata/524/behaviour/73754465186_524_final.mat'...
    '../rawdata/525/behaviour/73754465215_525_final.mat'...
    '../rawdata/526/behaviour/73754561157_526_final.mat'...
    '../rawdata/527/behaviour/73754465187_527_final.mat'...
    '../rawdata/528-End-Crash/behaviour/73754561165_528_26.mat'...
    '../rawdata/529/behaviour/73754646463_529_final.mat'...
    '../rawdata/530/behaviour/73754561168_530_final.mat'...
     '../rawdata/532/behaviour/73754561144_532_final.mat'...
     '../rawdata/533/behaviour/73754646463_533_final.mat'...
     '../rawdata/534/behaviour/73754646485_534_final.mat'...
     '../rawdata/535/behaviour/73754647027_535_final.mat'...
     '../rawdata/536/behaviour/73754646464_536_final.mat'...
     '../rawdata/537/behaviour/73754761350_537_final.mat'...
     '../rawdata/539/behaviour/73755848526_539_final.mat'...
     '../rawdata/540/behaviour/73755848502_540_final.mat'...
     '../rawdata/541/behaviour/73755861584_541_final.mat'...
     '../rawdata/542/behaviour/73756257210_542_final.mat'...
     '../rawdata/544/behaviour/73755861171_544_final.mat'...
     '../rawdata/545/behaviour/73755861157_545_final.mat'...
     '../rawdata/546/behaviour/73755861154_546_final.mat'...
     '../rawdata/547/behaviour/73756257941_547_final.mat'...
     '../rawdata/548/behaviour/73756257568_548_final.mat'...
     '../rawdata/549/behaviour/73756560757_549_final.mat'...
     '../rawdata/550/behaviour/73756648490_550_final.mat'...
     '../rawdata/551/behaviour/73756648517_551_final.mat'...
     '../rawdata/552/behaviour/73756649719_552_final.mat'...
     '../rawdata/553/behaviour/73756648548_553_final.mat'...
     '../rawdata/554/behaviour/73756648501_554_final.mat'...
    '../rawdata/604/behaviour/73760048394_604_final.mat'...
    '../rawdata/605/behaviour/73760148400_605_final.mat'...
    '../rawdata/606/behaviour/73760161146_606_final.mat'...
    '../rawdata/607/behaviour/73760161137_607_final.mat'...
    '../rawdata/608/behaviour/73760861570_608_final.mat'...
    '../rawdata/609/behaviour/73761460811_609_final.mat'...
    '../rawdata/610/behaviour/73761661171_610_final.mat'...
    '../rawdata/611/behaviour/73761661162_611_final.mat'...
    '../rawdata/612/behaviour/73761661161_612_final.mat'...
    '../rawdata/613/behaviour/73761661220_613_final.mat'...
    '../rawdata/614/behaviour/73761661197_614_final.mat'...
    '../rawdata/615/behaviour/73761761379_615_final.mat'...
    '../rawdata/616/behaviour/73761760950_616_final.mat'...
    '../rawdata/617/behaviour/73761760969_617_final.mat'...
    '../rawdata/618/behaviour/73762046121_618_final.mat'...
    '../rawdata/619/behaviour/73762046127_619_final.mat'...
    '../rawdata/620/behaviour/73762276864_620_final.mat'...
    '../rawdata/621/behaviour/73762354904_621_final.mat'...
    '../rawdata/622/behaviour/73762537977_622_final.mat'...
    '../rawdata/623/behaviour/73762554655_623_final.mat'...
    '../rawdata/624/behaviour/73762571496_624_final.mat'...
    '../rawdata/625/behaviour/73762571471_625_final.mat'...
    '../rawdata/626/behaviour/73762746075_626_final.mat'...
    '../rawdata/627/behaviour/73762877098_627_final.mat'...
    '../rawdata/628/behaviour/73762861087_628_final.mat'...
    '../rawdata/629/behaviour/73762961116_629_final.mat'...
    '../rawdata/630/behaviour/73762977440_630_final.mat'...
    '../rawdata/631/behaviour/73763648175_631_final.mat'...
    '../rawdata/632/behaviour/73763673776_632_final.mat'...
    '../rawdata/633/behaviour/73763765156_633_final.mat'...
    '../rawdata/634/behaviour/73763946323_634_final.mat'...
    '../rawdata/635/behaviour/73763965149_635_final.mat'...
    '../rawdata/636/behaviour/73763966179_636_final.mat'...
    '../rawdata/637/behaviour/73764046849_637_final.mat'...
    '../rawdata/638/behaviour/73764146875_638_final.mat'...
    '../rawdata/639/behaviour/73764448396_639_final.mat'...
    '../rawdata/640/behaviour/73764461016_640_final.mat'...
    '../rawdata/641/behaviour/73764461034_641_final.mat'...
    '../rawdata/642/behaviour/73764461036_642_final.mat'...
    '../rawdata/643/behaviour/73764542458_643_final.mat'};

for p = 1:120
    %% Load Data
    path = paths{p};
    dirs = dir(path);
    fileName = dirs(1).name;
    
    rates = m_getRates(paths{p}, 0.10);
    
    lowers(p) = nanmean(rates(rates(:, 1) < 0.5, 2));
    highers(p) = nanmean(rates(rates(:, 1) > 0.5, 2));
end

%% Plot Model
m_plotAllTTest(lowers, highers);

%% Test Model
[h, p, ci, stats] = ttest(lowers, highers);
